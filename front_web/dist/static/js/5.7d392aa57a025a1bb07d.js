webpackJsonp([5],{"1oQo":function(t,e,a){var o=a("Uqxy");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("62b85fde",o,!0)},"59Yp":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("Vo7i");function r(t){return Object(o.a)({url:"/overseas/getGoodsCategory",method:"post",data:{parent_id:t}})}var s={data:function(){var t=function(t,e,a){""==e?a(new Error("不能为空！")):a()};return{dialogFormVisible:this.show,imgurl:"https://chunfeng.huobanys.cn/api/overseas/uploadImg",baseurl:"http://192.168.1.86:8009/storage/app/",options:[{category_id:"0",name:"顶级分类"}],form:{name:"",parent_id:"",sort:"50",status:"",icon:"",icon_show:""},rules:{name:[{required:!0,trigger:"blur",validator:function(t,e,a){""==e?a(new Error("不能为空！")):e.length>20?a(new Error("字数过多！")):a()}}],parent_id:[{required:!0,trigger:"change",validator:t}],status:[{required:!0,trigger:"change",validator:t}],icon:[{required:!0,trigger:"blur",validator:function(t,e,a){""==e?a(new Error("请上传图片！")):a()}}]}}},props:["show"],created:function(){this.firstCategory()},watch:{show:function(){this.dialogFormVisible=this.show}},methods:{submitform:function(){var t=this,e=this;this.$refs.addForm.validate(function(a){console.log(a),a?(r=t.form.parent_id,s=t.form.name,i=t.form.icon,l=t.form.sort,n=t.form.status,Object(o.a)({url:"/overseas/goodsCategoryModify",method:"post",data:{parent_id:r,name:s,icon:i,sort:l,status:n}})).then(function(a){console.log(a),"200"==a.data.status?(t.$message({showClose:!0,message:a.data.msg,type:"success"}),e.BcloseDialog()):t.$message({showClose:!0,message:a.data.msg,type:"error"})}).catch(function(t){console.log(t)}):t.$message({showClose:!0,message:"提交数据错误",type:"error"});var r,s,i,l,n})},closechild:function(t){this.$nextTick(function(){this.$refs[t].resetFields(),this.$emit("closedialog",!1)})},BcloseDialog:function(t){this.$nextTick(function(){this.$refs.addForm.resetFields(),this.$emit("closedialog",!1)}),t()},handleAvatarSuccess:function(t,e){console.log(t),this.form.icon=t.data,console.log(this.form.icon)},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,a="image/gif"===t.type,o="image/png"===t.type,r=t.size/1024/1024<2;return e||a||o||this.$message.error("上传图片必须是JPG/GIF/PNG 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),(e||a||o)&&r},firstCategory:function(){var t=this;r(0).then(function(e){console.log(e.data.data);for(var a=e.data.data,o=0;o<a.length;o++)t.options.push(a[o])}).catch(function(t){console.log(t)})}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"addCategory"}},[a("el-dialog",{attrs:{width:"80%",top:"5vh","before-close":t.BcloseDialog,title:"添加分类",visible:t.dialogFormVisible,"close-on-click-modal":!1,"lock-scroll":!0},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"addForm",attrs:{model:t.form,rules:t.rules}},[a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:10,offset:2}},[a("el-form-item",{attrs:{label:"分类名称",prop:"name"}},[a("el-input",{staticStyle:{width:"75%"},attrs:{"auto-complete":"off",placeholder:"20字以内"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"上级分类",prop:"parent_id"}},[a("el-select",{staticStyle:{width:"75%"},attrs:{placeholder:"请选择"},model:{value:t.form.parent_id,callback:function(e){t.$set(t.form,"parent_id",e)},expression:"form.parent_id"}},t._l(t.options,function(t){return a("el-option",{key:t.category_id,attrs:{label:t.name,value:t.category_id}})}))],1)],1)],1),t._v(" "),a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:10,offset:2}},[a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-input-number",{attrs:{size:"large","controls-position":"right",min:0},model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-select",{staticStyle:{width:"75%"},attrs:{placeholder:"请选择"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("el-option",{attrs:{label:"正常",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1)],1)],1),t._v(" "),a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:6,offset:2}},[a("el-form-item",{attrs:{label:"分类图片",prop:"icon"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.imgurl,accept:"image/jpeg,image/gif,image/png","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.form.icon?a("img",{staticClass:"avatar",attrs:{src:t.form.icon}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.closechild("addForm")}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){e.preventDefault(),t.submitform(e)}}},[t._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var l={data:function(){var t=function(t,e,a){""==e?a(new Error("不能为空！")):a()};return{dialogFormVisible:this.show,imgurl:"https://chunfeng.huobanys.cn/api/overseas/uploadImg",baseurl:"http://192.168.1.86:8009/storage/app/",options:[{category_id:"0",name:"顶级分类"}],form:{name:"",parent_id:"",sort:"50",status:"",icon:"",icon_show:""},rules:{name:[{required:!0,trigger:"blur",validator:function(t,e,a){""==e?a(new Error("不能为空！")):e.length>20?a(new Error("字数过多！")):a()}}],parent_id:[{required:!0,trigger:"change",validator:t}],status:[{required:!0,trigger:"change",validator:t}],icon:[{required:!0,trigger:"blur",validator:function(t,e,a){""==e?a(new Error("请上传图片！")):a()}}]}}},props:["show","id"],created:function(){this.getInfo(),this.firstCategory()},watch:{show:function(){this.dialogFormVisible=this.show}},methods:{getInfo:function(){var t=this,e=this;(a=this.id,Object(o.a)({url:"/overseas/goodsCategoryDetail",method:"post",data:{category_id:a}})).then(function(a){console.log(a),"200"==a.data.status?(e.form.name=a.data.data.name,e.form.parent_id=a.data.data.parent_id,e.form.sort=a.data.data.sort,e.form.status=a.data.data.status,e.form.icon=a.data.data.icon,e.form.icon_show=e.baseurl+a.data.data.icon):t.$message({showClose:!0,message:a.data.msg,type:"error"})}).catch(function(t){console.log(t)});var a},submitform:function(){var t=this,e=this;this.$refs.editForm.validate(function(a){console.log(a),a?(r=t.id,s=t.form.name,i=t.form.parent_id,l=t.form.sort,n=t.form.status,c=t.form.icon,Object(o.a)({url:"/overseas/goodsCategoryModify",method:"post",data:{category_id:r,parent_id:s,name:i,icon:l,sort:n,status:c}})).then(function(a){console.log(a),"200"==a.data.status?(t.$message({showClose:!0,message:a.data.msg,type:"success"}),e.BcloseDialog()):t.$message({showClose:!0,message:a.data.msg,type:"error"})}).catch(function(t){console.log(error)}):t.$message({showClose:!0,message:"提交数据错误",type:"error"});var r,s,i,l,n,c})},closechild:function(t){this.$nextTick(function(){this.$refs[t].resetFields(),this.$emit("closedialog",!1)})},BcloseDialog:function(t){this.$nextTick(function(){this.$refs.editForm.resetFields(),this.$emit("closedialog",!1)}),t()},handleAvatarSuccess:function(t,e){console.log(t),this.form.icon=t.data,console.log(this.form.icon)},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,a="image/gif"===t.type,o="image/png"===t.type,r=t.size/1024/1024<2;return e||a||o||this.$message.error("上传图片必须是JPG/GIF/PNG 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),(e||a||o)&&r},firstCategory:function(){var t=this;r(0).then(function(e){console.log(e.data.data);for(var a=e.data.data,o=0;o<a.length;o++)t.options.push(a[o])}).catch(function(t){console.log(t)})}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"editCategory"}},[a("el-dialog",{attrs:{width:"80%",top:"5vh","before-close":t.BcloseDialog,title:"编辑分类",visible:t.dialogFormVisible,"close-on-click-modal":!1,"lock-scroll":!0},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"editForm",attrs:{model:t.form,rules:t.rules}},[a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:10,offset:2}},[a("el-form-item",{attrs:{label:"分类名称",prop:"name"}},[a("el-input",{staticStyle:{width:"75%"},attrs:{"auto-complete":"off",placeholder:"20字以内"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"上级分类",prop:"parent_id"}},[a("el-select",{staticStyle:{width:"75%"},attrs:{placeholder:"请选择"},model:{value:t.form.parent_id,callback:function(e){t.$set(t.form,"parent_id",e)},expression:"form.parent_id"}},t._l(t.options,function(t){return a("el-option",{key:t.category_id,attrs:{label:t.name,value:t.category_id}})}))],1)],1)],1),t._v(" "),a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:10,offset:2}},[a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-input-number",{attrs:{size:"large","controls-position":"right",min:0},model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-select",{staticStyle:{width:"75%"},attrs:{placeholder:"请选择"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("el-option",{attrs:{label:"正常",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1)],1)],1),t._v(" "),a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:6,offset:2}},[a("el-form-item",{attrs:{label:"分类图片",prop:"icon"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.imgurl,accept:"image/jpeg,image/gif,image/png","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.form.icon?a("img",{staticClass:"avatar",attrs:{src:t.form.icon}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.closechild("editForm")}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){e.preventDefault(),t.submitform(e)}}},[t._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var c={data:function(){return{tableData:[],options:[{category_id:"0",name:"顶级分类"}],total:0,name:"",parent_id:"",status:"",addshow:!1,editshow:!1,id:""}},created:function(){this.getData(),this.firstCategory()},components:{addcategory:a("VU/8")(s,i,!1,function(t){a("1oQo")},null,null).exports,editcategory:a("VU/8")(l,n,!1,function(t){a("rbdx")},null,null).exports},mounted:function(){},methods:{getData:function(){var t=this;(e=this.name,a=this.parent_id,r=this.status,Object(o.a)({url:"/overseas/goodsCategoryList",method:"post",data:{name:e,parent_id:a,status:r}})).then(function(e){console.log(e.data.data),t.tableData=e.data.data}).catch(function(t){console.log(t)});var e,a,r},addAd:function(){this.addshow=!0},addChange:function(){this.addshow=!1,this.getData()},search:function(){this.getData()},editpt:function(t){this.id=t,this.editshow=!0},editChange:function(){this.editshow=!1,this.getData()},formatStatus:function(t,e,a){return 1===a?"正常":0===a?"禁用":void 0},firstCategory:function(){var t=this;r(0).then(function(e){console.log(e.data.data);for(var a=e.data.data,o=0;o<a.length;o++)t.options.push(a[o])}).catch(function(t){console.log(t)})},deletecategory:function(t){var e=this,a=this;(r=t,Object(o.a)({url:"/overseas/goodsCategoryDelete",method:"post",data:{category_id:r}})).then(function(t){console.log(t),"200"==t.data.status?(e.$message({showClose:!0,message:t.data.msg,type:"success"}),a.getData()):e.$message({showClose:!0,message:t.data.msg,type:"error"})}).catch(function(t){console.log(t)});var r}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"productCategories"}},[a("div",{staticClass:"handle-box"},[a("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:2}},[a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addAd()}}},[t._v("添加")])],1)],1)],1),t._v(" "),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,size:"small"}},[a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:15}},[a("el-form-item",{attrs:{label:"产品名称："}},[a("el-input",{attrs:{placeholder:"产品名称："},model:{value:t.name,callback:function(e){t.name="string"==typeof e?e.trim():e},expression:"name"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:15}},[a("el-form-item",{attrs:{label:"上级分类："}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.parent_id,callback:function(e){t.parent_id=e},expression:"parent_id"}},t._l(t.options,function(t){return a("el-option",{key:t.category_id,attrs:{label:t.name,value:t.category_id}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:15}},[a("el-form-item",{attrs:{label:"状态："}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[a("el-option",{attrs:{label:"正常",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1)],1),t._v(" "),a("el-col",[a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("搜索")])],1)],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"tablelist",staticStyle:{width:"100%"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"分类名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"parent_category_name",label:"上级分类"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sort",label:"排序"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",formatter:t.formatStatus}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){t.editpt(e.row.category_id)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){t.deletecategory(e.row.category_id)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),t.addshow?a("addcategory",{attrs:{show:t.addshow},on:{"update:show":function(e){t.addshow=e},closedialog:t.addChange}}):t._e(),t._v(" "),t.editshow?a("editcategory",{attrs:{show:t.editshow,id:t.id},on:{"update:show":function(e){t.editshow=e},"update:id":function(e){t.id=e},closedialog:t.editChange}}):t._e()],1)},staticRenderFns:[]},u=a("VU/8")(c,d,!1,null,null,null);e.default=u.exports},PHXc:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n#editCategory .avatar-uploader .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n  width: 100%;\n  height: 178px;\n}\n#editCategory .avatar-uploader .el-upload:hover {\n  border-color: #409EFF;\n}\n#editCategory .avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 100%;\n  height: 100%;\n  line-height: 178px;\n  text-align: center;\n}\n#editCategory .avatar {\n  width: 100%;\n  height: 100%;\n  display: block;\n}\n\n",""])},Uqxy:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n#addCategory .avatar-uploader .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n  width: 100%;\n  height: 178px;\n}\n#addCategory .avatar-uploader .el-upload:hover {\n  border-color: #409EFF;\n}\n#addCategory .avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 100%;\n  height: 100%;\n  line-height: 178px;\n  text-align: center;\n}\n#addCategory .avatar {\n  width: 100%;\n  height: 100%;\n  display: block;\n}\n\n",""])},rbdx:function(t,e,a){var o=a("PHXc");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("66c224fc",o,!0)}});